# Record

> 开发日志：

| 日期       | 做的事情                                                                                                                                                         | 用时 | 修改的文件                                                             | 未完成的事                                                                    | 备注                                                                                                                                                                                                            |
| ---------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---- | ---------------------------------------------------------------------- | ----------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 2023/04/** | 调研编译器实现路径，尝试了《自制编译器》、rvcc等各个开源学习项目                                                                                                 | /    | /                                                                      | /                                                                             |                                                                                                                                                                                                                 |
| 2023/04/18 | 确定自己将使用rust+risc-v完成编译器                                                                                                                              | 1.5  | /                                                                      |                                                                               | 新建文件夹                                                                                                                                                                                                      |
| 2023/04/19 | 1. 配置完成RISC-V交叉编译以及Cargo的交叉编译相关<br />2. 编译可返回特定数值的程序(interactive 初步)<br />3. GitHub-Git 版本管理                                | 4.5  | csrc/commit1/<br />rsrc/src/main.rs<br />rsrc/.cargo/<br />rsrc/*.toml | /<br />(表示满足)                                                             | 从04/19开始记录，正式开发                                                                                                                                                                                       |
| 2023/04/20 | 1. 支持+-<br />2. 终结符引入，支持空格处理，引入token处理（不完美且粗糙）                                                                                        | 7    | csrc/commit2/<br />csrc/commit3/<br />rsrc/src/main.rs                 |                                                                               | 对rust语法出现重大失误，commit3完成的不好                                                                                                                                                                       |
| 2023/04/21 | 1. 完善commit3的rust实现，达到较为满意的水平<br />2. 写错误信息提示系统，复习rust的宏写法，<br />    没办法实现跟C一样的效果，但勉强能看，后续再完善。         | 7    | csrc/commit4/<br />rsrc/src/                                           | 用宏实现错误处理系统                                                          |                                                                                                                                                                                                                 |
| 2023/04/22 | 1. 完善错误信息提示，达到心里可以接收的水平，commit4可以算是结束了<br />2. 探索rust-riscv64的交叉调试环境                                                        | 4    |                                                                        | 调试环境配置                                                                  | 使用了git rebase命令重新整理了我的commit记录<br />现在每次提交都会有一些功能的更新<br />方便做版本管理                                                                                                          |
| 2023/04/23 | 1. 配置成功交叉调试环境，可以调试交叉编译后的rust程序了<br />2. 尝试支持*/()，也就是乘除括号，引入AST，感觉有点麻烦                                              | 4    | csrc/commit5/<br />rsrc/src/                                           | AST语法树构建，递归向下                                                       | 想快速过一遍rust语法，否则效率不高                                                                                                                                                                              |
| 2023/04/24 | 继续扩充step4的实现，理解 tokenize -> AST -> genasm 的联系                                                                                                       | 2    | csrc/commit5/<br />rsrc/src/                                           | step4                                                                         | 从step3/commit4 到 step4/commit5 是挺难跨的一步<br />因为要引入一个新模块AST生成<br />以及将原先的代码生成整理为一个新模块<br />决定先去看rcore和ysyx了。                                                       |
| 2023/04/25 | 基本完成step4，能够编译、执行、写入.s文件，执行得到正确运算结果                                                                                                  | 4    | csrc/commit5/<br />rsrc/src<br />draft/(ignored)<br />refer/(ignored)  | step4的调试工作<br />使其通过全部算例<br />为之前的不严谨填坑                 | 真的狗，之前只看能不能生成.s文件<br />没有真正执行它<br />今天执行了发现step3的核心函数不能通过某些算例<br />step4是没有改动那个tokenize的...                                                                   |
| 2023/04/26 | step4调试完成，通过test.sh全部算例<br />增加step5，但是出现StackOverflow，百思不得其果                                                                           | 3    | csrc/commit6/<br />rsrc/src<br />.gitignore                            | 通过step5                                                                     | 在equal函数出现栈溢出，暂时没想明白怎么回事                                                                                                                                                                     |
| 2023/04/27 | 没有打开muservc项目，去忙攀登机器人项目的中期结项了                                                                                                              | 0    | /                                                                      | /                                                                             | /                                                                                                                                                                                                               |
| 2023/04/28 | 调试step5，通过test.sh，支持了+-的一元运算                                                                                                                       | 1    | csrc/commit6/<br />rsrc/                                               | /                                                                             | 休息一天(4.27)回来发现神清气爽<br />并没有复习rust语法<br />但是解决问题的思路多了很多<br />----------------------------<br />同时使用更多的gitignore来控制无关文件不被推送                                     |
| 2023/04/29 | 完成step6，通过了test.sh                                                                                                                                         | 3    | csrc/commit7/<br />rsrc/                                               | /                                                                             | 没有遇到太大的麻烦                                                                                                                                                                                              |
| 2023/04/30 | 完成step7，划分为多文件，向一个project迈进<br />尝试step8，加入分号划分多个语句                                                                                  | 4    | csrc/commit8/<br />csrc/commit9/<br />rsrc/                            | 面向对象的组织方式<br />或者其他更先进优越的组织方式<br />（目前是类C风格）） | 再分成多文件的过程中<br />初步体会了一个项目的组织安排的选择<br />有了一些面向对象的想法<br />留待后续改进                                                                                                      |
| 2023/05/01 | 初步完成step8的文法分析                                                                                                                                          | 2    |                                                                        |                                                                               | 累                                                                                                                                                                                                              |
| 2023/05/02 | /                                                                                                                                                                | 0    |                                                                        |                                                                               | 了                                                                                                                                                                                                              |
| 2023/05/03 | /                                                                                                                                                                | 0    |                                                                        |                                                                               | 开                                                                                                                                                                                                              |
| 2023/05/04 | 写完step8的代码生成，但是在next成员上遇到所有权的大问题                                                                                                          | 3    |                                                                        |                                                                               | 摆                                                                                                                                                                                                              |
| 2023/05/05 | 完成step8，通过test.sh<br />进行step9，尝试单字母变量和多字母变量的支持<br />完成step9，通过test.sh                                                              | 5    | csrc/commit10/<br />rsrc/                                              | 更优的软件结构                                                                | rust的所有权是双刃剑<br />虽然很严谨<br />但是实现起来可能没有C方便                                                                                                                                             |
| 2023/05/06 | 尝试step10                                                                                                                                                       | 4    |                                                                        | 感觉自己的代码结构很有问题                                                    |                                                                                                                                                                                                                 |
| 2023/05/07 | 做step10                                                                                                                                                         | 3    |                                                                        | 有点怀疑自己能不能继续。                                                      |                                                                                                                                                                                                                 |
| 2023/05/08 | 做step10                                                                                                                                                         | 2    |                                                                        |                                                                               |                                                                                                                                                                                                                 |
| 2023/05/09 | /                                                                                                                                                                | 0    | /                                                                      | /                                                                             | /                                                                                                                                                                                                               |
| 2023/05/10 | 一口气从头重写了大部分代码，调通step10<br />完成了step11的词法分析部分                                                                                           | 5    | csrc/commit11/<br />rsrc/                                              | 优化Function与Node数据结构，<br />将代码逐步改为struct+impl的模式             | 憋了很久<br />但调整后的代码结构应该比较容易增加功能                                                                                                                                                            |
| 2023/05/11 | 完成step11，通过test.sh<br />尝试step12                                                                                                                          | 3    | csrc/commit12/<br />rsrc/                                              |                                                                               | step11支持return语句，比较简单                                                                                                                                                                                  |
| 2023/05/12 | 完成step12，通过test.sh<br />完成step13，通过test.sh<br />尝试step14，完成词法和文法部分。<br />完成step14（调通了，你说怎么办哈哈）                             | 5    | csrc/commit13/<br />csrc/commit14/<br />csrc/commit15/<br />rsrc/      | 理清body与next之间的关系，简化数据结构                                        | 支持大括号，感觉自己的数据结构有一点复杂和冗余<br />需要调整。<br />空语句的支持比较简单。这里我放到了stmt层次来解析<br />if语句的支持也比较简单<br />=========================<br />运动提高效率啊，得多运动。 |
| 2023/05/13 | 完善step14的文档，推送<br />完成step15，通过test.sh<br />完成step16，通过test.sh<br />完成step17，产生一些汇编代码中的注释信息                                   | 4    | csrc/commit15/<br />csrc/commit16/<br />csrc/commit17&&18/<br />rsrc/  |                                                                               | 今天主要是关键词的增加<br />关键词功能的支持都比较简单                                                                                                                                                          |
| 2023/05/14 | 完成step18，完善codegen中的报错信息。<br />思考IR该怎么写（有一点幻灭感）<br />完成step19，通过test.sh<br />解决了一个堆栈分配的逻辑问题、以及一个stmt的语义问题 | 4    | csrc/commit19/<br />csrc/commit20/<br />rsrc/                          | 得思考AST->IR的框架了                                                         |                                                                                                                                                                                                                 |
